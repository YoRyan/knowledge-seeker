{% extends 'base.html' %}

{% set episode_kwargs = { 'season': season.slug, 'episode': episode.slug } %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='episode.css') }}">
{% endblock %}

{% block title %}
{{ episode.name }} - {{ season.name }}
{% endblock %}

{% block header %}
{% if season.icon is not none %}
<img class="season-icon"
     src="{{ url_for('explorer.season_icon', season=season.slug) }}"
     alt="">
{% endif %}
<a href="{{ url_for('explorer.browse_season', season=season.slug) }}">{{ season.name }}</a> |
{{ episode.name }}
{% endblock %}

{% block content %}
<section>
{% for subtitle in subtitles %}
        {% set start = subtitle.start.str_seconds() %}
        {% set end = subtitle.end.str_seconds() %}
        <a class="subtitle"
           style="margin-top: {{ subtitle.time_since_last*0.4 }}rem;"
           href="{{ url_for('explorer.browse_moment', timecode=subtitle.nav, **episode_kwargs) }}">
                <span class="image-timecode-wrap">
                        <img class="image"
                             src="{{ url_for('clipper.snapshot_tiny', timecode=subtitle.preview, **episode_kwargs) }}"
                             alt="">
        {% if start == end %}
                        <span class="timecode subtitle-range">{{ start }}</span>
        {% else %}
                        <span class="timecode subtitle-range">{{ start }} - {{ end }}</span>
        {% endif %}
                </span>
                <span class="subtitle-text">{{ subtitle.content|safe }}</span>
        </a>
{% endfor %}
</section>
{% endblock %}

